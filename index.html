<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Commercial - Po√™les & Granul√©s</title>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(45deg, #667eea, #764ba2);
            --success-color: #38a169;
            --warning-color: #ed8936;
            --danger-color: #e53e3e;
            --info-color: #3182ce;
            --glass-bg: rgba(255, 255, 255, 0.95);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--primary-gradient);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--glass-border);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .header h1 {
            color: #2d3748;
            font-size: clamp(2rem, 4vw, 2.5rem);
            margin-bottom: 15px;
            background: var(--secondary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            position: relative;
            z-index: 1;
        }

        .header p {
            color: #4a5568;
            font-size: 1.1rem;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }

        .stats-ticker {
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
            padding: 10px 20px;
            margin-top: 15px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 15px;
        }

        .ticker-item {
            text-align: center;
            min-width: 120px;
        }

        .ticker-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--info-color);
        }

        .ticker-label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 2px;
        }

        .tabs {
            display: flex;
            background: var(--glass-bg);
            border-radius: 15px;
            padding: 8px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
            gap: 5px;
            backdrop-filter: blur(10px);
        }

        .tab {
            flex: 1;
            min-width: 140px;
            padding: 15px 20px;
            border: none;
            background: transparent;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: #4a5568;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .tab::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: var(--secondary-gradient);
            transition: all 0.3s ease;
            transform: translate(-50%, -50%);
            z-index: -1;
        }

        .tab:hover::before {
            width: 120%;
            height: 120%;
        }

        .tab.active {
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .tab.active::before {
            width: 120%;
            height: 120%;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--glass-border);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            position: relative;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--secondary-gradient);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .card:hover::before {
            transform: scaleX(1);
        }

        .card h3 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4em;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(226, 232, 240, 0.5);
            transition: all 0.2s ease;
        }

        .metric:hover {
            background: rgba(102, 126, 234, 0.05);
            border-radius: 8px;
            padding-left: 10px;
            padding-right: 10px;
        }

        .metric:last-child {
            border-bottom: none;
        }

        .metric-label {
            font-weight: 500;
            color: #4a5568;
        }

        .metric-value {
            font-weight: 700;
            font-size: 1.2em;
            padding: 4px 12px;
            border-radius: 20px;
            transition: all 0.2s ease;
        }

        .positive { 
            color: white; 
            background: linear-gradient(45deg, var(--success-color), #48bb78);
            box-shadow: 0 4px 15px rgba(56, 161, 105, 0.3);
        }
        .negative { 
            color: white; 
            background: linear-gradient(45deg, var(--danger-color), #f56565);
            box-shadow: 0 4px 15px rgba(229, 62, 62, 0.3);
        }
        .neutral { 
            color: white; 
            background: linear-gradient(45deg, var(--info-color), #4299e1);
            box-shadow: 0 4px 15px rgba(49, 130, 206, 0.3);
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(226, 232, 240, 0.5);
            border-radius: 6px;
            margin: 15px 0;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #48bb78, #38a169);
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 6px;
            position: relative;
        }

        .progress-fill::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: progressShimmer 2s infinite;
        }

        @keyframes progressShimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .input-field {
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .input-field label {
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
            font-size: 0.9rem;
        }

        .input-field input, .input-field select {
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .input-field input:focus, .input-field select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .btn {
            padding: 12px 24px;
            background: var(--secondary-gradient);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            margin: 5px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-danger {
            background: linear-gradient(45deg, var(--danger-color), #f56565);
        }

        .btn-danger:hover {
            box-shadow: 0 10px 30px rgba(229, 62, 62, 0.4);
        }

        .chart-container {
            height: 320px;
            display: flex;
            align-items: end;
            justify-content: space-around;
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            overflow-x: auto;
            position: relative;
        }

        .chart-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="%23e2e8f0" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
            pointer-events: none;
        }

        .bar-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 90px;
            margin: 0 8px;
            position: relative;
            z-index: 1;
        }

        .bar {
            background: var(--secondary-gradient);
            border-radius: 6px 6px 0 0;
            min-height: 25px;
            width: 45px;
            position: relative;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
        }

        .bar:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .bar-label {
            margin-top: 12px;
            font-size: 0.85em;
            font-weight: 600;
            color: #4a5568;
            text-align: center;
            max-width: 70px;
            word-wrap: break-word;
        }

        .bar-value {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.85em;
            font-weight: bold;
            color: #2d3748;
            white-space: nowrap;
            background: white;
            padding: 2px 8px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .alert {
            padding: 16px 20px;
            border-radius: 12px;
            margin: 12px 0;
            font-weight: 600;
            border: none;
            position: relative;
            overflow: hidden;
        }

        .alert::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: currentColor;
        }

        .alert-success {
            background: rgba(72, 187, 120, 0.1);
            color: #2f855a;
            border-left: 4px solid var(--success-color);
        }

        .alert-warning {
            background: rgba(237, 137, 54, 0.1);
            color: #c05621;
            border-left: 4px solid var(--warning-color);
        }

        .alert-info {
            background: rgba(66, 153, 225, 0.1);
            color: #2b6cb0;
            border-left: 4px solid var(--info-color);
        }

        .prediction-card {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            position: relative;
            overflow: hidden;
        }

        .prediction-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .prediction-card h3 {
            color: white;
            position: relative;
            z-index: 1;
        }

        .ai-indicator {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            margin-left: 10px;
            backdrop-filter: blur(5px);
        }

        .floating-stats {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            padding: 15px 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            z-index: 1000;
            transition: all 0.3s ease;
            border: 1px solid var(--glass-border);
        }

        .floating-stats:hover {
            transform: scale(1.05);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 2000;
            transform: translateX(400px);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .notification.show {
            transform: translateX(0);
        }

        @media (max-width: 768px) {
            .container { padding: 10px; }
            .header { padding: 20px; margin-bottom: 20px; }
            .dashboard-grid { grid-template-columns: 1fr; gap: 15px; }
            .tabs { flex-direction: column; }
            .chart-container { height: 250px; padding: 15px; }
            .input-group { grid-template-columns: 1fr; }
            .floating-stats { display: none; }
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üî• Dashboard Commercial - Po√™les & Granul√©s</h1>
            <p>Suivi des performances en temps r√©el de votre √©quipe de vente</p>
            <div class="stats-ticker">
                <div class="ticker-item">
                    <div class="ticker-value" id="ticker-ca">0‚Ç¨</div>
                    <div class="ticker-label">CA Total</div>
                </div>
                <div class="ticker-item">
                    <div class="ticker-value" id="ticker-ventes">0</div>
                    <div class="ticker-label">Ventes</div>
                </div>
                <div class="ticker-item">
                    <div class="ticker-value" id="ticker-taux">0%</div>
                    <div class="ticker-label">Taux Global</div>
                </div>
                <div class="ticker-item">
                    <div class="ticker-value" id="ticker-objectif">0%</div>
                    <div class="ticker-label">Objectif</div>
                </div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('vue-ensemble')">üìä Vue d'ensemble</button>
            <button class="tab" onclick="showTab('vendeurs')">üë• Vendeurs</button>
            <button class="tab" onclick="showTab('objectifs')">üéØ Objectifs & Primes</button>
            <button class="tab" onclick="showTab('predictions')">ü§ñ Pr√©dictions IA</button>
            <button class="tab" onclick="showTab('tunnel')">üîÑ Tunnel conversion</button>
            <button class="tab" onclick="showTab('saisie')">üìù Saisie donn√©es</button>
            <button class="tab" onclick="showTab('admin')">‚öôÔ∏è Administration</button>
        </div>

        <!-- Vue d'ensemble -->
        <div id="vue-ensemble" class="tab-content active">
            <div class="dashboard-grid">
                <div class="card">
                    <h3>üìä Performances du mois</h3>
                    <div class="metric">
                        <span class="metric-label">Nombre de rdv</span>
                        <span class="metric-value neutral" id="total-prospects">0</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Ventes r√©alis√©es</span>
                        <span class="metric-value positive" id="total-ventes">0</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Taux transformation global</span>
                        <span class="metric-value" id="taux-global">0%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Marge moyenne √©quipe</span>
                        <span class="metric-value" id="marge-moyenne">0 ‚Ç¨</span>
                    </div>
                </div>

                <div class="card pulse">
                    <h3>üí∞ Chiffre d'affaires</h3>
                    <div class="metric">
                        <span class="metric-label">CA r√©alis√©</span>
                        <span class="metric-value positive" id="ca-realise">0 ‚Ç¨</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Objectif mensuel √©quipe</span>
                        <span class="metric-value neutral" id="objectif-ca-total">0 ‚Ç¨</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">√âcart objectif</span>
                        <span class="metric-value" id="ecart-ca">0 ‚Ç¨</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-ca" style="width: 0%"></div>
                    </div>
                </div>

                <div class="card">
                    <h3>üèÜ Top performer</h3>
                    <div class="metric">
                        <span class="metric-label">Meilleur vendeur</span>
                        <span class="metric-value positive" id="top-vendeur">-</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Taux de transformation</span>
                        <span class="metric-value positive" id="top-taux">0%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">CA g√©n√©r√©</span>
                        <span class="metric-value positive" id="top-ca">0 ‚Ç¨</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Primes gagn√©es</span>
                        <span class="metric-value positive" id="top-primes">0 ‚Ç¨</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‚ö†Ô∏è Alerte Marges</h3>
                    <div id="alertes-marges">
                        <!-- Alertes marges will be generated by JS -->
                    </div>
                </div>

                <div class="card" style="grid-column: 1 / -1;">
                    <h3>üéØ Performance vs Objectifs</h3>
                    <div class="chart-container" id="chart-objectifs">
                        <!-- Chart will be generated by JS -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Vendeurs -->
        <div id="vendeurs" class="tab-content">
            <div class="dashboard-grid" id="vendeurs-grid">
                <!-- Vendeurs cards will be generated by JS -->
            </div>
        </div>

        <!-- Objectifs & Primes -->
        <div id="objectifs" class="tab-content">
            <div class="dashboard-grid" id="objectifs-grid">
                <!-- Objectifs cards will be generated by JS -->
            </div>
        </div>

        <!-- Pr√©dictions IA -->
        <div id="predictions" class="tab-content">
            <div class="dashboard-grid">
                <div class="card prediction-card">
                    <h3>ü§ñ Pr√©dictions IA <span class="ai-indicator">IA</span></h3>
                    <div class="metric">
                        <span style="color: white;">CA pr√©vu fin de mois</span>
                        <span class="metric-value" id="prediction-ca" style="background: rgba(255,255,255,0.2); color: white;">0 ‚Ç¨</span>
                    </div>
                    <div class="metric">
                        <span style="color: white;">Probabilit√© atteinte objectif</span>
                        <span class="metric-value" id="prediction-probabilite" style="background: rgba(255,255,255,0.2); color: white;">0%</span>
                    </div>
                    <div class="metric">
                        <span style="color: white;">Tendance g√©n√©rale</span>
                        <span class="metric-value" id="prediction-tendance" style="background: rgba(255,255,255,0.2); color: white;">-</span>
                    </div>
                </div>

                <div class="card">
                    <h3>üìà Recommandations IA</h3>
                    <div id="recommendations-ia">
                        <!-- Recommendations will be generated by JS -->
                    </div>
                </div>

                <div class="card">
                    <h3>üéØ Vendeur √† coacher prioritairement</h3>
                    <div class="metric">
                        <span class="metric-label">Vendeur identifi√©</span>
                        <span class="metric-value negative" id="vendeur-coaching">-</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Raison principale</span>
                        <span class="metric-value neutral" id="raison-coaching">-</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Action sugg√©r√©e</span>
                        <span class="metric-value neutral" id="action-coaching">-</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tunnel conversion -->
        <div id="tunnel" class="tab-content">
            <div class="card">
                <h3>üîÑ Analyse du tunnel de conversion</h3>
                <div class="chart-container" id="tunnel-chart">
                    <!-- Tunnel chart will be generated by JS -->
                </div>
                <div class="alert alert-warning" id="tunnel-alert" style="display: none;">
                    <strong>‚ö†Ô∏è Point d'attention :</strong> <span id="tunnel-message"></span>
                </div>
            </div>
        </div>

        <!-- Saisie donn√©es -->
        <div id="saisie" class="tab-content">
            <div class="card">
                <h3>üìù Saisie des donn√©es commerciales</h3>
                
                <div class="input-group">
                    <div class="input-field">
                        <label>Vendeur</label>
                        <select id="vendeur-select">
                            <option value="Vincent">Vincent</option>
                            <option value="Raphael">Raphael</option>
                            <option value="L√©o">L√©o</option>
                            <option value="Pablo">Pablo</option>
                            <option value="Nathan">Nathan</option>
                        </select>
                    </div>
                    
                    <div class="input-field">
                        <label>Nombre de rdv</label>
                        <input type="number" id="prospects-input" placeholder="Nombre de prospects" min="0">
                    </div>
                    
                    <div class="input-field">
                        <label>Ventes finalis√©es</label>
                        <input type="number" id="ventes-input" placeholder="Nombre de ventes" min="0">
                    </div>
                    
                    <div class="input-field">
                        <label>CA g√©n√©r√© (‚Ç¨)</label>
                        <input type="number" id="ca-input" placeholder="Chiffre d'affaires" min="0">
                    </div>
                    
                    <div class="input-field">
                        <label>Marge moyenne</label>
                        <input type="number" id="marge-input" placeholder="Ex: 2200" min="0">
                    </div>
                    
                    <div class="input-field">
                        <label>Type majoritaire</label>
                        <select id="type-poele">
                            <option value="Bois">Po√™le √† bois</option>
                            <option value="Granul√©s">Po√™le √† granul√©s</option>
                            <option value="Mixte">Mixte bois/granul√©s</option>
                        </select>
                    </div>
                </div>
                
                <button class="btn" onclick="ajouterDonnees()">üíæ Enregistrer les donn√©es</button>
                
                <div id="success-message" class="alert alert-success" style="display: none;">
                    ‚úÖ Donn√©es enregistr√©es avec succ√®s !
                </div>
            </div>
        </div>

        <!-- Administration -->
        <div id="admin" class="tab-content">
            <div class="dashboard-grid">
                <div class="card">
                    <h3>‚öôÔ∏è Configuration des objectifs mensuels</h3>
                    
                    <div class="input-group">
                        <div class="input-field">
                            <label>Vendeur</label>
                            <select id="admin-vendeur-select">
                                <option value="Vincent">Vincent</option>
                                <option value="Raphael">Raphael</option>
                                <option value="L√©o">L√©o</option>
                                <option value="Pablo">Pablo</option>
                                <option value="Nathan">Nathan</option>
                            </select>
                        </div>
                        
                        <div class="input-field">
                            <label>Mois</label>
                            <select id="admin-mois-select">
                                <option value="Septembre 2025">Septembre 2025</option>
                                <option value="Octobre 2025">Octobre 2025</option>
                                <option value="Novembre 2025">Novembre 2025</option>
                                <option value="D√©cembre 2025">D√©cembre 2025</option>
                            </select>
                        </div>
                        
                        <div class="input-field">
                            <label>Objectif CA (‚Ç¨)</label>
                            <input type="number" id="admin-objectif-input" placeholder="Ex: 100000" min="0">
                        </div>
                    </div>
                    
                    <button class="btn" onclick="definirObjectif()">üéØ D√©finir l'objectif</button>
                </div>

                <div class="card">
                    <h3>üí∞ Configuration des paliers de primes</h3>
                    
                    <div class="input-group">
                        <div class="input-field">
                            <label>Seuil CA (‚Ç¨)</label>
                            <input type="number" id="admin-seuil-input" placeholder="Ex: 110000" min="0">
                        </div>
                        
                        <div class="input-field">
                            <label>Prime (‚Ç¨)</label>
                            <input type="number" id="admin-prime-input" placeholder="Ex: 500" min="0">
                        </div>
                    </div>
                    
                    <button class="btn" onclick="ajouterPalier()">üíé Ajouter un palier</button>
                    <button class="btn btn-danger" onclick="reinitialiserPaliers()">üóëÔ∏è R√©initialiser</button>
                    
                    <div id="paliers-preview" class="paliers-container" style="display: none;">
                        <h4>Paliers actuels :</h4>
                        <div id="paliers-list"></div>
                    </div>
                </div>

                <div class="card">
                    <h3>üìä Actions globales</h3>
                    <button class="btn" onclick="exporterDonnees()">üì• Exporter les donn√©es</button>
                    <button class="btn btn-danger" onclick="reinitialiserDonnees()">üîÑ R√©initialiser toutes les donn√©es</button>
                    
                    <div class="alert alert-info">
                        <strong>‚ÑπÔ∏è Info :</strong> Les donn√©es sont stock√©es localement dans votre navigateur. Pour sauvegarder d√©finitivement, utilisez l'export.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating stats widget -->
    <div class="floating-stats" id="floating-stats">
        <div style="font-size: 0.9rem; color: #666; margin-bottom: 5px;">Performance temps r√©el</div>
        <div style="font-weight: bold; color: #667eea;" id="floating-perf">Chargement...</div>
    </div>

    <!-- Notification system -->
    <div class="notification" id="notification">
        <span id="notification-text"></span>
    </div>

    <script>
        // Donn√©es des vendeurs avec vrais noms et marges
        let vendeursData = {
            'Vincent': { prospects: 15, devis: 8, ventes: 3, ca: 32000, type: 'Bois', objectif: 80000, marge: 1800 },
            'Raphael': { prospects: 12, devis: 9, ventes: 5, ca: 78000, type: 'Granul√©s', objectif: 100000, marge: 2100 },
            'L√©o': { prospects: 18, devis: 6, ventes: 2, ca: 28000, type: 'Bois', objectif: 75000, marge: 1750 },
            'Pablo': { prospects: 20, devis: 12, ventes: 6, ca: 82000, type: 'Granul√©s', objectif: 90000, marge: 2250 },
            'Nathan': { prospects: 10, devis: 7, ventes: 4, ca: 65000, type: 'Mixte', objectif: 85000, marge: 2050 }
        };

        // Configuration des paliers de primes
        let paliersGlobaux = [
            { seuil: 0, prime: 0 },
            { seuil: 80000, prime: 200 },
            { seuil: 90000, prime: 350 },
            { seuil: 100000, prime: 500 },
            { seuil: 110000, prime: 750 }
        ];

        // Marge minimum requise
        const MARGE_MINIMUM = 2000;

        // Notification system
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const text = document.getElementById('notification-text');
            
            text.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function showTab(tabName) {
            // Cacher tous les contenus
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            
            // D√©sactiver tous les tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Activer le tab et contenu s√©lectionn√©s
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Mettre √† jour les donn√©es selon le tab
            setTimeout(() => {
                switch(tabName) {
                    case 'vue-ensemble':
                        updateVueEnsemble();
                        break;
                    case 'vendeurs':
                        updateVendeurs();
                        break;
                    case 'objectifs':
                        updateObjectifs();
                        break;
                    case 'predictions':
                        updatePredictions();
                        break;
                    case 'tunnel':
                        updateTunnel();
                        break;
                }
            }, 100);
        }

        function calculerPrime(ca) {
            let primeTotal = 0;
            for (let i = paliersGlobaux.length - 1; i >= 0; i--) {
                if (ca >= paliersGlobaux[i].seuil) {
                    primeTotal = paliersGlobaux[i].prime;
                    break;
                }
            }
            return primeTotal;
        }

        function updateTicker() {
            let totalCA = 0, totalVentes = 0, totalProspects = 0, totalObjectif = 0;
            
            for (let vendeur in vendeursData) {
                const data = vendeursData[vendeur];
                totalCA += data.ca;
                totalVentes += data.ventes;
                totalProspects += data.prospects;
                totalObjectif += data.objectif;
            }
            
            const tauxGlobal = totalProspects > 0 ? (totalVentes / totalProspects * 100) : 0;
            const progressObjectif = totalObjectif > 0 ? (totalCA / totalObjectif * 100) : 0;
            
            document.getElementById('ticker-ca').textContent = totalCA.toLocaleString() + '‚Ç¨';
            document.getElementById('ticker-ventes').textContent = totalVentes;
            document.getElementById('ticker-taux').textContent = tauxGlobal.toFixed(1) + '%';
            document.getElementById('ticker-objectif').textContent = progressObjectif.toFixed(1) + '%';
            
            // Floating stats
            const floatingStats = document.getElementById('floating-perf');
            if (floatingStats) {
                floatingStats.innerHTML = `CA: ${totalCA.toLocaleString()}‚Ç¨<br>Progression: ${progressObjectif.toFixed(1)}%`;
            }
        }

        function updateVueEnsemble() {
            let totalProspects = 0, totalDevis = 0, totalVentes = 0, totalCA = 0, totalObjectif = 0, totalMarge = 0;
            let bestVendeur = '', bestTaux = 0, bestCA = 0, bestPrimes = 0;
            let vendeursEnAlerteMarge = [];

            for (let vendeur in vendeursData) {
                const data = vendeursData[vendeur];
                totalProspects += data.prospects;
                totalDevis += data.devis;
                totalVentes += data.ventes;
                totalCA += data.ca;
                totalObjectif += data.objectif;
                totalMarge += data.marge * data.ventes;

                const taux = data.prospects > 0 ? (data.ventes / data.prospects * 100) : 0;
                const primes = calculerPrime(data.ca);
                
                if (taux > bestTaux) {
                    bestTaux = taux;
                    bestVendeur = vendeur;
                    bestCA = data.ca;
                    bestPrimes = primes;
                }

                if (data.marge < MARGE_MINIMUM) {
                    vendeursEnAlerteMarge.push({
                        nom: vendeur,
                        marge: data.marge,
                        ecart: MARGE_MINIMUM - data.marge
                    });
                }
            }

            const tauxGlobal = totalProspects > 0 ? (totalVentes / totalProspects * 100) : 0;
            const ecartCA = totalCA - totalObjectif;
            const progressCA = Math.min(100, totalObjectif > 0 ? (totalCA / totalObjectif) * 100 : 0);
            const margeMoyenne = totalVentes > 0 ? totalMarge / totalVentes : 0;

            // Mise √† jour des √©l√©ments
            document.getElementById('total-prospects').textContent = totalProspects;
            document.getElementById('total-devis').textContent = totalDevis;
            document.getElementById('total-ventes').textContent = totalVentes;
            document.getElementById('taux-global').textContent = tauxGlobal.toFixed(1) + '%';
            document.getElementById('taux-global').className = 'metric-value ' + (tauxGlobal >= 20 ? 'positive' : tauxGlobal >= 15 ? 'neutral' : 'negative');

            document.getElementById('marge-moyenne').textContent = Math.round(margeMoyenne).toLocaleString() + ' ‚Ç¨';
            document.getElementById('marge-moyenne').className = 'metric-value ' + (margeMoyenne >= MARGE_MINIMUM ? 'positive' : 'negative');

            document.getElementById('ca-realise').textContent = totalCA.toLocaleString() + ' ‚Ç¨';
            document.getElementById('objectif-ca-total').textContent = totalObjectif.toLocaleString() + ' ‚Ç¨';
            document.getElementById('ecart-ca').textContent = (ecartCA >= 0 ? '+' : '') + ecartCA.toLocaleString() + ' ‚Ç¨';
            document.getElementById('ecart-ca').className = 'metric-value ' + (ecartCA >= 0 ? 'positive' : 'negative');
            
            // Animation pour la barre de progression
            setTimeout(() => {
                document.getElementById('progress-ca').style.width = progressCA + '%';
            }, 300);

            document.getElementById('top-vendeur').textContent = bestVendeur;
            document.getElementById('top-taux').textContent = bestTaux.toFixed(1) + '%';
            document.getElementById('top-ca').textContent = bestCA.toLocaleString() + ' ‚Ç¨';
            document.getElementById('top-primes').textContent = bestPrimes.toLocaleString() + ' ‚Ç¨';

            updateAlertesMarges(vendeursEnAlerteMarge);
            updateChart();
            updateTicker();
        }

        function updateAlertesMarges(vendeursEnAlerte) {
            const container = document.getElementById('alertes-marges');
            
            if (vendeursEnAlerte.length === 0) {
                container.innerHTML = `
                    <div class="alert alert-success">
                        <strong>‚úÖ Excellent !</strong> Tous les vendeurs respectent la marge minimum de ${MARGE_MINIMUM.toLocaleString()}‚Ç¨
                    </div>
                `;
            } else {
                let alertesHTML = `
                    <div class="alert alert-warning">
                        <strong>‚ö†Ô∏è ${vendeursEnAlerte.length} vendeur(s) en dessous de la marge minimum :</strong>
                    </div>
                `;
                
                vendeursEnAlerte.forEach(vendeur => {
                    alertesHTML += `
                        <div class="alert alert-warning" style="margin: 8px 0; padding: 12px;">
                            <strong>${vendeur.nom}</strong> : ${vendeur.marge.toLocaleString()}‚Ç¨ 
                            (-${vendeur.ecart.toLocaleString()}‚Ç¨)
                            <br><small>üí° Action : revoir strat√©gie tarifaire</small>
                        </div>
                    `;
                });
                
                container.innerHTML = alertesHTML;
            }
        }

        function updateVendeurs() {
            const grid = document.getElementById('vendeurs-grid');
            grid.innerHTML = '';

            for (let vendeur in vendeursData) {
                const data = vendeursData[vendeur];
                const taux = data.prospects > 0 ? (data.ventes / data.prospects * 100) : 0;
                const tauxDevis = data.devis > 0 ? (data.ventes / data.devis * 100) : 0;
                const progressObjectif = data.objectif > 0 ? (data.ca / data.objectif) * 100 : 0;
                const primes = calculerPrime(data.ca);

                const card = document.createElement('div');
                card.className = 'card';
                card.style.borderLeft = '4px solid #667eea';
                card.innerHTML = `
                    <h3>üë§ ${vendeur}</h3>
                    <div class="metric">
                        <span class="metric-label">Prospects trait√©s</span>
                        <span class="metric-value neutral">${data.prospects}</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Ventes r√©alis√©es</span>
                        <span class="metric-value positive">${data.ventes}</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Taux transformation</span>
                        <span class="metric-value ${taux >= 25 ? 'positive' : taux >= 20 ? 'neutral' : 'negative'}">${taux.toFixed(1)}%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Taux devis ‚Üí vente</span>
                        <span class="metric-value ${tauxDevis >= 60 ? 'positive' : tauxDevis >= 45 ? 'neutral' : 'negative'}">${tauxDevis.toFixed(1)}%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">CA g√©n√©r√©</span>
                        <span class="metric-value positive">${data.ca.toLocaleString()} ‚Ç¨</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Objectif mensuel</span>
                        <span class="metric-value neutral">${data.objectif.toLocaleString()} ‚Ç¨</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Progression objectif</span>
                        <span class="metric-value ${progressObjectif >= 100 ? 'positive' : progressObjectif >= 80 ? 'neutral' : 'negative'}">${progressObjectif.toFixed(1)}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${Math.min(100, progressObjectif)}%"></div>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Primes gagn√©es</span>
                        <span class="metric-value positive">${primes.toLocaleString()} ‚Ç¨</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Marge moyenne par vente</span>
                        <span class="metric-value ${data.marge >= MARGE_MINIMUM ? 'positive' : 'negative'}">${data.marge.toLocaleString()} ‚Ç¨</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Type principal</span>
                        <span class="metric-value neutral">${data.type}</span>
                    </div>
                    ${data.marge < MARGE_MINIMUM ? `<div class="alert alert-warning" style="margin-top: 10px;"><strong>‚ö†Ô∏è Marge insuffisante :</strong> ${MARGE_MINIMUM - data.marge}‚Ç¨ en dessous du minimum requis</div>` : ''}
                `;
                grid.appendChild(card);
            }
        }

        function updateObjectifs() {
            const grid = document.getElementById('objectifs-grid');
            grid.innerHTML = '';

            for (let vendeur in vendeursData) {
                const data = vendeursData[vendeur];
                const progressObjectif = data.objectif > 0 ? (data.ca / data.objectif) * 100 : 0;
                const primes = calculerPrime(data.ca);
                
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <h3>üéØ ${vendeur}</h3>
                    <div class="metric">
                        <span class="metric-label">Objectif mensuel</span>
                        <span class="metric-value neutral">${data.objectif.toLocaleString()} ‚Ç¨</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">CA actuel</span>
                        <span class="metric-value ${data.ca >= data.objectif ? 'positive' : 'neutral'}">${data.ca.toLocaleString()} ‚Ç¨</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Progression</span>
                        <span class="metric-value ${progressObjectif >= 100 ? 'positive' : progressObjectif >= 80 ? 'neutral' : 'negative'}">${progressObjectif.toFixed(1)}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${Math.min(100, progressObjectif)}%"></div>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Primes actuelles</span>
                        <span class="metric-value positive">${primes.toLocaleString()} ‚Ç¨</span>
                    </div>
                    <div style="background: rgba(102, 126, 234, 0.05); border-radius: 10px; padding: 15px; margin-top: 15px;">
                        <h4 style="margin-bottom: 10px; color: #4a5568;">Paliers de primes :</h4>
                        ${generatePaliersHTML(data.ca)}
                    </div>
                `;
                grid.appendChild(card);
            }
        }

        function generatePaliersHTML(caActuel) {
            let html = '';
            paliersGlobaux.forEach(palier => {
                const isAtteint = caActuel >= palier.seuil;
                const statusIcon = isAtteint ? '‚úÖ' : '‚è≥';
                html += `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; ${isAtteint ? 'background: rgba(72, 187, 120, 0.1); border-radius: 6px; padding-left: 10px; padding-right: 10px;' : ''}">
                        <span>${statusIcon} ${palier.seuil.toLocaleString()} ‚Ç¨ et +</span>
                        <span style="background: ${isAtteint ? '#48bb78' : '#cbd5e0'}; color: ${isAtteint ? 'white' : '#4a5568'}; padding: 4px 12px; border-radius: 15px; font-weight: bold; font-size: 0.9em;">${palier.prime} ‚Ç¨</span>
                    </div>
                `;
            });
            return html;
        }

        function updatePredictions() {
            let totalCA = 0, totalObjectif = 0, tendances = [];

            for (let vendeur in vendeursData) {
                const data = vendeursData[vendeur];
                totalCA += data.ca;
                totalObjectif += data.objectif;
                
                const progressJour = data.ca / 20;
                const projectionFinMois = progressJour * 30;
                tendances.push({
                    vendeur: vendeur,
                    projection: projectionFinMois,
                    objectif: data.objectif,
                    performance: data.objectif > 0 ? projectionFinMois / data.objectif : 0
                });
            }

            const progressMoyen = totalObjectif > 0 ? totalCA / totalObjectif : 0;
            const projectionGlobale = (totalCA / 20) * 30;
            const probabiliteSucces = Math.min(95, progressMoyen * 100);

            document.getElementById('prediction-ca').textContent = Math.round(projectionGlobale).toLocaleString() + ' ‚Ç¨';
            document.getElementById('prediction-probabilite').textContent = Math.round(probabiliteSucces) + '%';
            
            const tendanceText = probabiliteSucces >= 80 ? 'üìà Excellente' : 
                               probabiliteSucces >= 60 ? 'üìä Bonne' : 'üìâ √Ä surveiller';
            document.getElementById('prediction-tendance').textContent = tendanceText;

            updateRecommendationsIA(tendances);

            const vendeurEnDifficulte = tendances.reduce((min, vendeur) => 
                vendeur.performance < min.performance ? vendeur : min
            );

            document.getElementById('vendeur-coaching').textContent = vendeurEnDifficulte.vendeur;
            
            if (vendeurEnDifficulte.performance < 0.7) {
                document.getElementById('raison-coaching').textContent = 'Performance < 70% objectif';
                document.getElementById('action-coaching').textContent = 'Accompagnement terrain urgent';
            } else if (vendeurEnDifficulte.performance < 0.9) {
                document.getElementById('raison-coaching').textContent = 'Risque de non-atteinte objectif';
                document.getElementById('action-coaching').textContent = 'Coaching closing & suivi prospects';
            } else {
                document.getElementById('raison-coaching').textContent = 'Optimisation performance';
                document.getElementById('action-coaching').textContent = 'Partage bonnes pratiques √©quipe';
            }
        }

        function updateRecommendationsIA(tendances) {
            const container = document.getElementById('recommendations-ia');
            let recommendations = [];

            const performancesMoyennes = tendances.reduce((acc, v) => acc + v.performance, 0) / tendances.length;
            
            if (performancesMoyennes < 0.8) {
                recommendations.push('üéØ Session de coaching collectif sur les techniques de closing');
                recommendations.push('üìû Intensifier le suivi des devis en cours');
            }
            
            const vendeurTop = tendances.reduce((max, v) => v.performance > max.performance ? v : max);
            if (vendeurTop.performance > 1.2) {
                recommendations.push(`üåü Demander √† ${vendeurTop.vendeur} de partager ses bonnes pratiques`);
            }

            const vendeursEnRetard = tendances.filter(v => v.performance < 0.7).length;
            if (vendeursEnRetard > 1) {
                recommendations.push('‚ö†Ô∏è Revoir les objectifs individuels - plusieurs vendeurs en difficult√©');
            }

            const vendeursMargesFaibles = Object.entries(vendeursData).filter(([nom, data]) => data.marge < MARGE_MINIMUM);
            if (vendeursMargesFaibles.length > 0) {
                recommendations.push(`üí∞ Formation n√©gociation tarifaire pour ${vendeursMargesFaibles.length} vendeur(s)`);
                recommendations.push('üìã Revoir la grille tarifaire et argumentaire valeur');
            }

            recommendations.push('üí° Focus qualification prospects pour am√©liorer taux transformation');
            recommendations.push('üìà Augmenter fr√©quence relance devis (J+3, J+7, J+14)');

            container.innerHTML = recommendations.map(rec => `
                <div class="alert alert-info" style="margin: 10px 0; padding: 15px; border-left: 4px solid var(--info-color);">
                    ${rec}
                </div>
            `).join('');
        }

        function updateTunnel() {
            let totalProspects = 0, totalDevis = 0, totalVentes = 0;
            
            for (let vendeur in vendeursData) {
                const data = vendeursData[vendeur];
                totalProspects += data.prospects;
                totalDevis += data.devis;
                totalVentes += data.ventes;
            }

            const tauxProspectDevis = totalProspects > 0 ? (totalDevis / totalProspects * 100) : 0;
            const tauxDevisVente = totalDevis > 0 ? (totalVentes / totalDevis * 100) : 0;

            const chart = document.getElementById('tunnel-chart');
            chart.innerHTML = `
                <div class="bar-group">
                    <div class="bar" style="height: ${Math.max(25, Math.min(250, totalProspects * 3))}px; background: linear-gradient(to top, #4299e1, #3182ce);">
                        <div class="bar-value">${totalProspects}</div>
                    </div>
                    <div class="bar-label">Prospects</div>
                </div>
                <div style="display: flex; align-items: center; margin: 0 15px; flex-direction: column;">
                    <div style="color: #4a5568; font-weight: bold; font-size: 1rem; margin-bottom: 5px;">${tauxProspectDevis.toFixed(1)}%</div>
                    <div style="width: 40px; height: 3px; background: linear-gradient(45deg, #cbd5e0, #a0aec0); border-radius: 2px;"></div>
                    <div style="font-size: 1.8em; margin-top: 5px;">‚û°Ô∏è</div>
                </div>
                <div class="bar-group">
                    <div class="bar" style="height: ${Math.max(25, Math.min(250, totalDevis * 5))}px; background: linear-gradient(to top, #ed8936, #dd6b20);">
                        <div class="bar-value">${totalDevis}</div>
                    </div>
                    <div class="bar-label">Devis</div>
                </div>
                <div style="display: flex; align-items: center; margin: 0 15px; flex-direction: column;">
                    <div style="color: #4a5568; font-weight: bold; font-size: 1rem; margin-bottom: 5px;">${tauxDevisVente.toFixed(1)}%</div>
                    <div style="width: 40px; height: 3px; background: linear-gradient(45deg, #cbd5e0, #a0aec0); border-radius: 2px;"></div>
                    <div style="font-size: 1.8em; margin-top: 5px;">‚û°Ô∏è</div>
                </div>
                <div class="bar-group">
                    <div class="bar" style="height: ${Math.max(25, Math.min(250, totalVentes * 8))}px; background: linear-gradient(to top, #48bb78, #38a169);">
                        <div class="bar-value">${totalVentes}</div>
                    </div>
                    <div class="bar-label">Ventes</div>
                </div>
            `;

            // Analyse et alerte
            const alert = document.getElementById('tunnel-alert');
            const message = document.getElementById('tunnel-message');
            
            if (tauxProspectDevis < 50) {
                alert.style.display = 'block';
                message.textContent = `Taux prospect‚Üídevis faible (${tauxProspectDevis.toFixed(1)}%). Focus sur la qualit√© de la d√©couverte client.`;
            } else if (tauxDevisVente < 45) {
                alert.style.display = 'block';
                message.textContent = `Taux devis‚Üívente faible (${tauxDevisVente.toFixed(1)}%). Focus sur la conclusion et le suivi commercial.`;
            } else {
                alert.style.display = 'none';
            }
        }

        function updateChart() {
            const chart = document.getElementById('chart-objectifs');
            const vendeurs = Object.keys(vendeursData);

            let chartHTML = '<div style="display: flex; align-items: end; height: 100%; justify-content: space-around; overflow-x: auto; min-width: 100%; padding: 10px;">';
            
            const maxObjectif = Math.max(...Object.values(vendeursData).map(v => v.objectif));
            
            vendeurs.forEach(vendeur => {
                const data = vendeursData[vendeur];
                const maxHeight = 200;
                
                const heightObjectif = Math.max(25, (data.objectif / maxObjectif) * maxHeight);
                const heightCA = Math.max(25, (data.ca / maxObjectif) * maxHeight);
                
                const colorCA = data.ca >= data.objectif ? 'linear-gradient(to top, #48bb78, #38a169)' : 
                              data.ca >= data.objectif * 0.8 ? 'linear-gradient(to top, #ed8936, #dd6b20)' : 'linear-gradient(to top, #e53e3e, #c53030)';
                
                chartHTML += `
                    <div class="bar-group" style="margin: 0 10px;">
                        <div style="display: flex; align-items: end; gap: 8px;">
                            <div class="bar" style="height: ${heightObjectif}px; background: linear-gradient(to top, #cbd5e0, #a0aec0); width: 28px; position: relative;">
                                <div class="bar-value" style="color: #4a5568; font-size: 0.8em;">${(data.objectif/1000).toFixed(0)}k‚Ç¨</div>
                            </div>
                            <div class="bar" style="height: ${heightCA}px; background: ${colorCA}; width: 28px; position: relative;">
                                <div class="bar-value" style="font-size: 0.8em;">${(data.ca/1000).toFixed(0)}k‚Ç¨</div>
                            </div>
                        </div>
                        <div class="bar-label" style="margin-top: 15px; font-size: 0.9em; font-weight: 700;">${vendeur}</div>
                        <div style="font-size: 0.75em; color: #666; margin-top: 2px;">
                            ${((data.ca / data.objectif) * 100).toFixed(1)}%
                        </div>
                    </div>
                `;
            });
            chartHTML += '</div>';
            
            // L√©gende
            chartHTML += `
                <div style="display: flex; justify-content: center; gap: 20px; margin-top: 15px; font-size: 0.85em;">
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <div style="width: 15px; height: 15px; background: linear-gradient(to top, #cbd5e0, #a0aec0); border-radius: 2px;"></div>
                        <span>Objectif</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <div style="width: 15px; height: 15px; background: linear-gradient(to top, #48bb78, #38a169); border-radius: 2px;"></div>
                        <span>CA R√©alis√©</span>
                    </div>
                </div>
            `;
            
            chart.innerHTML = chartHTML;
        }

        // Fonctions d'administration
        function definirObjectif() {
            const vendeur = document.getElementById('admin-vendeur-select').value;
            const objectif = parseInt(document.getElementById('admin-objectif-input').value) || 0;
            
            if (objectif > 0) {
                vendeursData[vendeur].objectif = objectif;
                document.getElementById('admin-objectif-input').value = '';
                
                showNotification(`Objectif d√©fini avec succ√®s pour ${vendeur} : ${objectif.toLocaleString()}‚Ç¨`);
                updateVueEnsemble();
            } else {
                showNotification('Veuillez saisir un objectif valide', 'warning');
            }
        }

        function ajouterPalier() {
            const seuil = parseInt(document.getElementById('admin-seuil-input').value) || 0;
            const prime = parseInt(document.getElementById('admin-prime-input').value) || 0;
            
            if (seuil > 0 && prime >= 0) {
                const existingIndex = paliersGlobaux.findIndex(p => p.seuil === seuil);
                if (existingIndex >= 0) {
                    paliersGlobaux[existingIndex].prime = prime;
                } else {
                    paliersGlobaux.push({ seuil: seuil, prime: prime });
                }
                
                paliersGlobaux.sort((a, b) => a.seuil - b.seuil);
                
                document.getElementById('admin-seuil-input').value = '';
                document.getElementById('admin-prime-input').value = '';
                
                showPaliersPreview();
                showNotification(`Palier ajout√© : ${seuil.toLocaleString()}‚Ç¨ ‚Üí ${prime}‚Ç¨`);
            } else {
                showNotification('Veuillez saisir des valeurs valides', 'warning');
            }
        }

        function showPaliersPreview() {
            const container = document.getElementById('paliers-preview');
            const list = document.getElementById('paliers-list');
            
            list.innerHTML = paliersGlobaux.map(palier => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #e2e8f0;">
                    <span style="font-weight: 600;">${palier.seuil.toLocaleString()} ‚Ç¨ et +</span>
                    <span style="background: linear-gradient(45deg, #48bb78, #38a169); color: white; padding: 6px 15px; border-radius: 20px; font-weight: bold;">${palier.prime} ‚Ç¨</span>
                </div>
            `).join('');
            
            container.style.display = 'block';
        }

        function reinitialiserPaliers() {
            if (confirm('√ätes-vous s√ªr de vouloir r√©initialiser tous les paliers de primes ?')) {
                paliersGlobaux = [
                    { seuil: 0, prime: 0 },
                    { seuil: 80000, prime: 200 },
                    { seuil: 90000, prime: 350 },
                    { seuil: 100000, prime: 500 },
                    { seuil: 110000, prime: 750 }
                ];
                showPaliersPreview();
                showNotification('Paliers r√©initialis√©s aux valeurs par d√©faut');
            }
        }

        function ajouterDonnees() {
            const vendeur = document.getElementById('vendeur-select').value;
            const prospects = parseInt(document.getElementById('prospects-input').value) || 0;
            const devis = parseInt(document.getElementById('devis-input').value) || 0;
            const ventes = parseInt(document.getElementById('ventes-input').value) || 0;
            const ca = parseInt(document.getElementById('ca-input').value) || 0;
            const marge = parseInt(document.getElementById('marge-input').value) || 0;
            const type = document.getElementById('type-poele').value;

            if (prospects === 0 && devis === 0 && ventes === 0 && ca === 0) {
                showNotification('Veuillez saisir au moins une donn√©e', 'warning');
                return;
            }

            // Validation coh√©rence des donn√©es
            if (ventes > devis && devis > 0) {
                showNotification('Le nombre de ventes ne peut pas √™tre sup√©rieur au nombre de devis', 'warning');
                return;
            }

            if (devis > prospects && prospects > 0) {
                showNotification('Le nombre de devis ne peut pas √™tre sup√©rieur au nombre de prospects', 'warning');
                return;
            }

            // Mise √† jour des donn√©es
            const ventesActuelles = vendeursData[vendeur].ventes;
            const margeActuelle = vendeursData[vendeur].marge;
            
            vendeursData[vendeur].prospects += prospects;
            vendeursData[vendeur].devis += devis;
            vendeursData[vendeur].ventes += ventes;
            vendeursData[vendeur].ca += ca;
            
            // Calcul de la nouvelle marge moyenne pond√©r√©e
            if (ventes > 0 && marge > 0) {
                const margeTotal = (margeActuelle * ventesActuelles) + (marge * ventes);
                vendeursData[vendeur].marge = Math.round(margeTotal / (ventesActuelles + ventes));
            }
            
            if (type !== vendeursData[vendeur].type) {
                vendeursData[vendeur].type = type;
            }

            // R√©initialiser les champs
            ['prospects-input', 'devis-input', 'ventes-input', 'ca-input', 'marge-input'].forEach(id => {
                document.getElementById(id).value = '';
            });

            showNotification(`Donn√©es enregistr√©es pour ${vendeur} !`);
            updateVueEnsemble();
            
            // Animation du bouton
            const btn = event.target;
            btn.innerHTML = '<span class="loading-spinner"></span> Enregistrement...';
            btn.disabled = true;
            
            setTimeout(() => {
                btn.innerHTML = 'üíæ Enregistrer les donn√©es';
                btn.disabled = false;
            }, 1000);
        }

        function exporterDonnees() {
            const dataToExport = {
                vendeurs: vendeursData,
                paliers: paliersGlobaux,
                dateExport: new Date().toISOString(),
                version: "2.0"
            };
            
            const blob = new Blob([JSON.stringify(dataToExport, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `dashboard-commercial-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Donn√©es export√©es avec succ√®s !');
        }

        function reinitialiserDonnees() {
            if (confirm('‚ö†Ô∏è ATTENTION : Cette action va supprimer toutes les donn√©es des vendeurs. √ätes-vous s√ªr ?')) {
                vendeursData = {
                    'Vincent': { prospects: 0, devis: 0, ventes: 0, ca: 0, type: 'Bois', objectif: 80000, marge: 2000 },
                    'Raphael': { prospects: 0, devis: 0, ventes: 0, ca: 0, type: 'Granul√©s', objectif: 100000, marge: 2000 },
                    'L√©o': { prospects: 0, devis: 0, ventes: 0, ca: 0, type: 'Bois', objectif: 75000, marge: 2000 },
                    'Pablo': { prospects: 0, devis: 0, ventes: 0, ca: 0, type: 'Granul√©s', objectif: 90000, marge: 2000 },
                    'Nathan': { prospects: 0, devis: 0, ventes: 0, ca: 0, type: 'Mixte', objectif: 85000, marge: 2000 }
                };
                updateVueEnsemble();
                showNotification('‚ö†Ô∏è Toutes les donn√©es ont √©t√© r√©initialis√©es !', 'warning');
            }
        }

        // Animation d'entr√©e pour les cartes
        function animateCards() {
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                setTimeout(() => {
                    card.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        }

        // Auto-update des donn√©es toutes les 30 secondes (simulation temps r√©el)
        function autoUpdate() {
            // Simulation de micro-variations dans les donn√©es pour effet temps r√©el
            const vendeurs = Object.keys(vendeursData);
            const randomVendeur = vendeurs[Math.floor(Math.random() * vendeurs.length)];
            
            // Petites variations al√©atoires tr√®s occasionnelles
            if (Math.random() < 0.1) { // 10% de chance
                const variation = Math.floor(Math.random() * 3) - 1; // -1, 0, ou +1
                if (variation !== 0) {
                    vendeursData[randomVendeur].prospects += Math.max(0, variation);
                    updateTicker();
                }
            }
        }

        // Initialisation au chargement
        document.addEventListener('DOMContentLoaded', function() {
            updateVueEnsemble();
            showPaliersPreview();
            animateCards();
            
            // D√©marrer les auto-updates
            setInterval(autoUpdate, 30000); // Toutes les 30 secondes
            
            // Message de bienvenue
            setTimeout(() => {
                showNotification('Dashboard charg√© avec succ√®s ! üöÄ');
            }, 1000);
        });

        // Gestion du redimensionnement de fen√™tre
        window.addEventListener('resize', function() {
            // Re-dessiner les graphiques si n√©cessaire
            if (document.getElementById('vue-ensemble').classList.contains('active')) {
                updateChart();
            }
        });

        // Gestion des raccourcis clavier
        document.addEventListener('keydown', function(e) {
            // Alt + 1-7 pour naviguer entre les tabs
            if (e.altKey && e.key >= '1' && e.key <= '7') {
                e.preventDefault();
                const tabs = ['vue-ensemble', 'vendeurs', 'objectifs', 'predictions', 'tunnel', 'saisie', 'admin'];
                const tabIndex = parseInt(e.key) - 1;
                if (tabs[tabIndex]) {
                    const tabButton = document.querySelector(`.tab:nth-child(${tabIndex + 1})`);
                    if (tabButton) {
                        tabButton.click();
                    }
                }
            }
        });

        // D√©tection de l'inactivit√© pour √©conomiser les ressources
        let lastActivity = Date.now();
        let isActive = true;

        function resetActivity() {
            lastActivity = Date.now();
            isActive = true;
        }

        document.addEventListener('mousemove', resetActivity);
        document.addEventListener('keydown', resetActivity);
        document.addEventListener('click', resetActivity);

        setInterval(() => {
            if (Date.now() - lastActivity > 300000) { // 5 minutes d'inactivit√©
                isActive = false;
            }
        }, 60000); // V√©rification toutes les minutes

        // Sauvegarde automatique dans localStorage
        function saveToLocalStorage() {
            try {
                const dataToSave = {
                    vendeurs: vendeursData,
                    paliers: paliersGlobaux,
                    lastSaved: Date.now()
                };
                localStorage.setItem('dashboardData', JSON.stringify(dataToSave));
            } catch (e) {
                console.warn('Impossible de sauvegarder dans localStorage:', e);
            }
        }

        function loadFromLocalStorage() {
            try {
                const savedData = localStorage.getItem('dashboardData');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    if (data.vendeurs && data.paliers) {
                        vendeursData = data.vendeurs;
                        paliersGlobaux = data.paliers;
                        
                        // Message de r√©cup√©ration
                        const lastSaved = new Date(data.lastSaved).toLocaleString();
                        showNotification(`Donn√©es restaur√©es (${lastSaved})`, 'info');
                    }
                }
            } catch (e) {
                console.warn('Impossible de charger depuis localStorage:', e);
            }
        }

        // Sauvegarder √† chaque modification
        const originalAjouterDonnees = ajouterDonnees;
        const originalDefinirObjectif = definirObjectif;
        const originalAjouterPalier = ajouterPalier;

        function ajouterDonnees() {
            originalAjouterDonnees();
            saveToLocalStorage();
        }

        function definirObjectif() {
            originalDefinirObjectif();
            saveToLocalStorage();
        }

        function ajouterPalier() {
            originalAjouterPalier();
            saveToLocalStorage();
        }

        // Charger les donn√©es au d√©marrage
        // loadFromLocalStorage(); // D√©comment√© si vous voulez la persistance
    </script>
</body>
</html>
                    
